Fundación Dr. Manuel Sadosky - Programa STIC Advisory
www.fundacionsadosky.org.ar

Mercadolibre Android Application Missing Server Certificate Validation


1. *Advisory Information*

Title: Mercadolibre Android Application Missing Server Certificate Validation
Advisory ID: STIC-2014-0211
Advisory URL: http://www.fundacionsadosky.org.ar/publicaciones-2
Date published: 2014-10-27
Date of last update: 2014-10-27
Vendors contacted: Mercadolibre
Release mode: Coordinated release


2. *Vulnerability Information*

Class: Improper Following of a Certificate's Chain of Trust [CWE-296]
Impact: Data loss
Remotely Exploitable: No
Locally Exploitable: Yes
CVE Identifier: N/A


3. *Vulnerability Description*
 
       MercadoLibre android application [1] doesn't verify the certificate presented by the server. 
       This allows attackers to present fake certificates and perform Man-in-the-Middle attacks allowing him to see user's credentials to the site and credit card information.
    

4. *Vulnerable packages*

   . Android applications running MercadoLibre older than version 3.10.6.

5. *Vendor Information, Solutions and Workarounds*
 
     MercadoLibre acknowledged and fixed the vulnerability in version 3.10.6. They did so by updating the loopj library, in which the certificate validation process is not skipped by default. 
     
      To determine which version of the applications you have installed on your Android device, go to "Settings|application settings|manage application" then tap on the MercadoLibre app.
    

6. *Credits*

This vulnerability was discovered and researched by Joaquín Manuel Rinaudo. The publication of this advisory was coordinated by Programa Seguridad en TIC. 

7. *Technical Description*

      MercadoLibre Android's application uses loopj's library [2] to communicate to its server.
      HTTP Requests destined to the server are passed through the interface 'MLAPIClient' to this library, which is responsible for establishing a secure connection. 
    
      The vulnerability is found in the class 'AsyncHttpClient' inside loopj library, which uses the class 'FakeSocketFactory' to set up new sockets used to connect to MercadoLibre's server. The sockets created use a custom X509TrustManager named 'FakeTrustManager'. The TrustManager's task is to check the certificate presented by the server in order to prevent Man-in-the-Middle attacks. Since 'FakeTrustManager' is just an empty implementation, all presented certificates will be valid ones. This allows attacker to mount this kinds of attacks by intercepting traffic generated by the application. 
   

8. *Report Timeline*

. 2014-09-09:
Programa Seguridad en TIC sent the vendor a description of the vulnerability to MercadoLibre, notifying them also that Computer Emergency Response Team [3] had published a document listing applications that failed to validate SSL in which they where included, making the vulnerability now public.
        

. 2014-09-09:

           The vendor acknowledged the vulnerability and assured that the problem was being addressed.
        

. 2014-09-27:

           The vendor informed that the released MercadoLibre version 3.10.6 fixed the vulnerability.  
        

. 2014-10-27:

        The advisory was released.
        


9. *References*

[1] https://play.google.com/store/apps/details?id=com.mercadolibre
[2] https://github.com/loopj/android-async-http
[3] http://www.kb.cert.org/vuls/id/582497

10. *About Fundación Dr. Manuel Sadosky*

The Dr. Manuel Sadosky Foundation is a mixed (public / private) institution whose goal is to promote stronger and closer interaction between industry and the scientific-technological system in all aspects related to Information and Communications Technology (ICT). The Foundation was formally created by a Presidential Decree in 2009. Its Chairman is the Minister of Science, Technology, and Productive Innovation of Argentina; and the Vice-chairmen are the chairmen of the country’s most important ICT chambers: The Software and Computer Services Chamber (CESSI) and the Argentine Computing and Telecommunications Chamber (CICOMRA). For more information visit: https://www.fundacionsadosky.org.ar

11. *Copyright Notice*

The contents of this advisory are copyright (c) 2014 Fundación Sadosky and are licensed under a Creative Commons Attribution Non-Commercial Share-Alike 4.0 License: http://creativecommons.org/licenses/by-nc-sa/4.0/